import{f as Z,r as x,g as ce,h as W,i as ne,j as T,k as de,c as b,o as u,b as I,a as v,T as ge,w as U,l as C,m as n,t as H,n as F,p as se,q as oe,s as le,v as Y,x as S,y as E,P as re,z as fe,A as pe,B as me,C as ve,D as ye,E as ee,F as X,G as he,H as be,I as xe,J as _e,K as ke,L as Te,M as Se,N as Ie,u as ze}from"./BhCHE_D-.js";const te=globalThis.setInterval,we={class:"flex flex-col items-center justify-center p-6"},qe={key:0,class:"absolute top-2 left-2 right-2 p-3 rounded-lg bg-primary/10 border border-primary text-center text-sm font-medium text-primary animate-pulse"},Ce={class:"relative mb-6"},$e={class:"transform -rotate-90",width:"200",height:"200"},Re=["stroke-dasharray","stroke-dashoffset"],Ae={class:"absolute inset-0 flex flex-col items-center justify-center"},Fe={class:"text-4xl font-bold text-highlighted mb-1"},De={class:"text-sm text-muted"},Ne={class:"flex gap-2"},Q=1500,ae=300,J="sphinx-focus-timer",Oe=Z({__name:"FocusTimer",setup(y,{expose:f}){const c=x("focus"),t=x("idle"),o=x(Q),i=x(null),p=x(!1),l=ce();function d(){const s={mode:c.value,state:t.value,timeRemaining:o.value,lastUpdateTimestamp:Date.now()};try{localStorage.setItem(J,JSON.stringify(s))}catch(e){console.error("Failed to save timer state:",e)}}function m(){try{const s=localStorage.getItem(J);if(!s)return;const e=JSON.parse(s);if(!e||typeof e.mode!="string"||typeof e.state!="string"||typeof e.timeRemaining!="number"||typeof e.lastUpdateTimestamp!="number"){localStorage.removeItem(J);return}if(c.value=e.mode,t.value=e.state,e.state==="running"){const a=Date.now(),h=Math.floor((a-e.lastUpdateTimestamp)/1e3),w=e.timeRemaining-h;if(w<=0){o.value=0,A();return}else o.value=w,t.value="running",i.value=te(()=>{o.value>0?(o.value--,d()):A()},1e3)}else o.value=e.timeRemaining}catch(s){console.error("Failed to load timer state:",s),localStorage.removeItem(J)}}W([c,t],()=>{d()},{immediate:!1}),ne(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),m()});function q(){try{const s=new(window.AudioContext||window.webkitAudioContext),e=s.createOscillator(),a=s.createGain();e.connect(a),a.connect(s.destination),e.frequency.value=800,e.type="sine",a.gain.setValueAtTime(.3,s.currentTime),a.gain.exponentialRampToValueAtTime(.01,s.currentTime+.5),e.start(s.currentTime),e.stop(s.currentTime+.5)}catch{}}function D(s){if("Notification"in window&&Notification.permission==="granted"){const e=s==="focus"?"Focus session complete!":"Break is over!",a=s==="focus"?"Time for a break.":"Ready to focus again?";new Notification(e,{body:a,icon:"/favicon.ico"})}}function G(s){const e=s==="focus"?"Focus session complete!":"Break is over!",a=s==="focus"?"Great work! Time for a well-deserved break.":"Ready to focus again?";l.add({title:e,description:a,icon:s==="focus"?"i-lucide-coffee":"i-lucide-zap",color:s==="focus"?"success":"primary"})}const $=T(()=>c.value==="focus"?Q:ae),j=T(()=>($.value-o.value)/$.value*100),N=T(()=>2*Math.PI*90),L=T(()=>N.value-j.value/100*N.value),O=T(()=>{const s=Math.floor(o.value/60),e=o.value%60;return`${String(s).padStart(2,"0")}:${String(e).padStart(2,"0")}`}),K=T(()=>c.value==="focus"?"Focus":"Rest");function z(){if(t.value==="running"){R();return}t.value="running",d(),i.value=te(()=>{o.value>0?(o.value--,d()):A()},1e3)}function R(){i.value&&(clearInterval(i.value),i.value=null),t.value="paused",d()}function B(){R(),t.value="idle",o.value=$.value,localStorage.removeItem(J)}function V(){R(),c.value==="focus"?(c.value="rest",o.value=ae):(c.value="focus",o.value=Q),t.value="idle",d()}function A(){const s=c.value;q(),D(s),G(s),p.value=!0,setTimeout(()=>{p.value=!1},3e3),V()}function M(){V()}return de(()=>{i.value&&clearInterval(i.value)}),f({mode:c,state:t,timeRemaining:o,formattedTime:O}),(s,e)=>{const a=se;return u(),b("div",we,[I(ge,{name:"fade"},{default:U(()=>[n(p)?(u(),b("div",qe," Session complete! ðŸŽ‰ ")):C("",!0)]),_:1}),v("div",Ce,[(u(),b("svg",$e,[e[0]||(e[0]=v("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"currentColor","stroke-width":"8",class:"text-border opacity-20"},null,-1)),v("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"currentColor","stroke-width":"8","stroke-dasharray":n(N),"stroke-dashoffset":n(L),class:"text-primary transition-all duration-1000 ease-linear","stroke-linecap":"round"},null,8,Re)])),v("div",Ae,[v("div",Fe,H(n(O)),1),v("div",De,H(n(K)),1)])]),v("div",Ne,[n(t)==="idle"?(u(),F(a,{key:0,label:"Start",icon:"i-lucide-play",color:"primary",onClick:z})):n(t)==="running"?(u(),F(a,{key:1,label:"Pause",icon:"i-lucide-pause",color:"warning",onClick:R})):n(t)==="paused"?(u(),F(a,{key:2,label:"Resume",icon:"i-lucide-play",color:"primary",onClick:z})):C("",!0),I(a,{label:"Skip",icon:"i-lucide-skip-forward",color:"neutral",variant:"outline",onClick:M}),I(a,{label:"Reset",icon:"i-lucide-rotate-ccw",color:"neutral",variant:"outline",disabled:n(t)==="idle"&&n(o)===n($),onClick:B},null,8,["disabled"])])])}}}),Be=Object.assign(Oe,{__name:"FocusTimer"}),Ve={slots:{root:"rounded-lg overflow-hidden",header:"p-4 sm:px-6",body:"p-4 sm:p-6",footer:"p-4 sm:px-6"},variants:{variant:{solid:{root:"bg-inverted text-inverted"},outline:{root:"bg-default ring ring-default divide-y divide-default"},soft:{root:"bg-elevated/50 divide-y divide-default"},subtle:{root:"bg-elevated/50 ring ring-default divide-y divide-default"}}},defaultVariants:{variant:"outline"}},Ue={__name:"UCard",props:{as:{type:null,required:!1},variant:{type:null,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(y){const f=y,c=oe(),t=le(),o=T(()=>Y({extend:Y(Ve),...t.ui?.card||{}})({variant:f.variant}));return(i,p)=>(u(),F(n(re),{as:y.as,"data-slot":"root",class:S(o.value.root({class:[f.ui?.root,f.class]}))},{default:U(()=>[c.header?(u(),b("div",{key:0,"data-slot":"header",class:S(o.value.header({class:f.ui?.header}))},[E(i.$slots,"header")],2)):C("",!0),c.default?(u(),b("div",{key:1,"data-slot":"body",class:S(o.value.body({class:f.ui?.body}))},[E(i.$slots,"default")],2)):C("",!0),c.footer?(u(),b("div",{key:2,"data-slot":"footer",class:S(o.value.footer({class:f.ui?.footer}))},[E(i.$slots,"footer")],2)):C("",!0)]),_:3},8,["as","class"]))}},Le={slots:{root:"relative inline-flex items-center",base:["w-full rounded-md border-0 appearance-none placeholder:text-dimmed focus:outline-none disabled:cursor-not-allowed disabled:opacity-75","transition-colors"],leading:"absolute inset-y-0 start-0 flex items-center",leadingIcon:"shrink-0 text-dimmed",leadingAvatar:"shrink-0",leadingAvatarSize:"",trailing:"absolute inset-y-0 end-0 flex items-center",trailingIcon:"shrink-0 text-dimmed"},variants:{fieldGroup:{horizontal:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-e-none group-not-only:group-last:rounded-s-none group-not-last:group-not-first:rounded-none"},vertical:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-b-none group-not-only:group-last:rounded-t-none group-not-last:group-not-first:rounded-none"}},size:{xs:{base:"px-2 py-1 text-xs gap-1",leading:"ps-2",trailing:"pe-2",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},sm:{base:"px-2.5 py-1.5 text-xs gap-1.5",leading:"ps-2.5",trailing:"pe-2.5",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},md:{base:"px-2.5 py-1.5 text-sm gap-1.5",leading:"ps-2.5",trailing:"pe-2.5",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},lg:{base:"px-3 py-2 text-sm gap-2",leading:"ps-3",trailing:"pe-3",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},xl:{base:"px-3 py-2 text-base gap-2",leading:"ps-3",trailing:"pe-3",leadingIcon:"size-6",leadingAvatarSize:"xs",trailingIcon:"size-6"}},variant:{outline:"text-highlighted bg-default ring ring-inset ring-accented",soft:"text-highlighted bg-elevated/50 hover:bg-elevated focus:bg-elevated disabled:bg-elevated/50",subtle:"text-highlighted bg-elevated ring ring-inset ring-accented",ghost:"text-highlighted bg-transparent hover:bg-elevated focus:bg-elevated disabled:bg-transparent dark:disabled:bg-transparent",none:"text-highlighted bg-transparent"},color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},leading:{true:""},trailing:{true:""},loading:{true:""},highlight:{true:""},type:{file:"file:me-1.5 file:font-medium file:text-muted file:outline-none"}},compoundVariants:[{color:"primary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary"},{color:"secondary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-secondary"},{color:"success",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-success"},{color:"info",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-info"},{color:"warning",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-warning"},{color:"error",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-error"},{color:"primary",highlight:!0,class:"ring ring-inset ring-primary"},{color:"secondary",highlight:!0,class:"ring ring-inset ring-secondary"},{color:"success",highlight:!0,class:"ring ring-inset ring-success"},{color:"info",highlight:!0,class:"ring ring-inset ring-info"},{color:"warning",highlight:!0,class:"ring ring-inset ring-warning"},{color:"error",highlight:!0,class:"ring ring-inset ring-error"},{color:"neutral",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-inverted"},{color:"neutral",highlight:!0,class:"ring ring-inset ring-inverted"},{leading:!0,size:"xs",class:"ps-7"},{leading:!0,size:"sm",class:"ps-8"},{leading:!0,size:"md",class:"ps-9"},{leading:!0,size:"lg",class:"ps-10"},{leading:!0,size:"xl",class:"ps-11"},{trailing:!0,size:"xs",class:"pe-7"},{trailing:!0,size:"sm",class:"pe-8"},{trailing:!0,size:"md",class:"pe-9"},{trailing:!0,size:"lg",class:"pe-10"},{trailing:!0,size:"xl",class:"pe-11"},{loading:!0,leading:!0,class:{leadingIcon:"animate-spin"}},{loading:!0,leading:!1,trailing:!0,class:{trailingIcon:"animate-spin"}}],defaultVariants:{size:"md",color:"primary",variant:"outline"}},Me=["id","type","value","name","placeholder","disabled","required","autocomplete"],Ee=Object.assign({inheritAttrs:!1},{__name:"UInput",props:{as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},type:{type:null,required:!1,default:"text"},placeholder:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},required:{type:Boolean,required:!1},autocomplete:{type:null,required:!1,default:"off"},autofocus:{type:Boolean,required:!1},autofocusDelay:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1},highlight:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},modelModifiers:{type:Object,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},icon:{type:null,required:!1},avatar:{type:Object,required:!1},leading:{type:Boolean,required:!1},leadingIcon:{type:null,required:!1},trailing:{type:Boolean,required:!1},trailingIcon:{type:null,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:null,required:!1}},emits:["update:modelValue","blur","change"],setup(y,{expose:f,emit:c}){const t=y,o=c,i=oe(),p=fe(t,"modelValue",o,{defaultValue:t.defaultValue}),l=le(),{emitFormBlur:d,emitFormInput:m,emitFormChange:q,size:D,color:G,id:$,name:j,highlight:N,disabled:L,emitFormFocus:O,ariaAttrs:K}=pe(t,{}),{orientation:z,size:R}=me(t),{isLeading:B,isTrailing:V,leadingIconName:A,trailingIconName:M}=ve(t),s=T(()=>R.value||D.value),e=T(()=>Y({extend:Y(Le),...l.ui?.input||{}})({type:t.type,color:G.value,variant:t.variant,size:s?.value,loading:t.loading,highlight:N.value,leading:B.value||!!t.avatar||!!i.leading,trailing:V.value||!!i.trailing,fieldGroup:z.value})),a=ye("inputRef");function h(r){t.modelModifiers?.trim&&(r=r?.trim()??null),(t.modelModifiers?.number||t.type==="number")&&(r=be(r)),t.modelModifiers?.nullable&&(r||=null),t.modelModifiers?.optional&&(r||=void 0),p.value=r,m()}function w(r){t.modelModifiers?.lazy||h(r.target.value)}function _(r){const P=r.target.value;t.modelModifiers?.lazy&&h(P),t.modelModifiers?.trim&&(r.target.value=P.trim()),q(),o("change",r)}function g(r){d(),o("blur",r)}function k(){t.autofocus&&a.value?.focus()}return ne(()=>{setTimeout(()=>{k()},t.autofocusDelay)}),f({inputRef:a}),(r,P)=>(u(),F(n(re),{as:y.as,"data-slot":"root",class:S(e.value.root({class:[t.ui?.root,t.class]}))},{default:U(()=>[v("input",ee({id:n($),ref_key:"inputRef",ref:a,type:y.type,value:n(p),name:n(j),placeholder:y.placeholder,"data-slot":"base",class:e.value.base({class:t.ui?.base}),disabled:n(L),required:y.required,autocomplete:y.autocomplete},{...r.$attrs,...n(K)},{onInput:w,onBlur:g,onChange:_,onFocus:P[0]||(P[0]=(...ue)=>n(O)&&n(O)(...ue))}),null,16,Me),E(r.$slots,"default",{ui:e.value}),n(B)||y.avatar||i.leading?(u(),b("span",{key:0,"data-slot":"leading",class:S(e.value.leading({class:t.ui?.leading}))},[E(r.$slots,"leading",{ui:e.value},()=>[n(B)&&n(A)?(u(),F(X,{key:0,name:n(A),"data-slot":"leadingIcon",class:S(e.value.leadingIcon({class:t.ui?.leadingIcon}))},null,8,["name","class"])):y.avatar?(u(),F(he,ee({key:1,size:t.ui?.leadingAvatarSize||e.value.leadingAvatarSize()},y.avatar,{"data-slot":"leadingAvatar",class:e.value.leadingAvatar({class:t.ui?.leadingAvatar})}),null,16,["size","class"])):C("",!0)])],2)):C("",!0),n(V)||i.trailing?(u(),b("span",{key:1,"data-slot":"trailing",class:S(e.value.trailing({class:t.ui?.trailing}))},[E(r.$slots,"trailing",{ui:e.value},()=>[n(M)?(u(),F(X,{key:0,name:n(M),"data-slot":"trailingIcon",class:S(e.value.trailingIcon({class:t.ui?.trailingIcon}))},null,8,["name","class"])):C("",!0)])],2)):C("",!0)]),_:3},8,["as","class"]))}}),Ge={class:"space-y-4"},je={class:"flex gap-2"},Ke={key:0,class:"text-center py-8 text-muted"},Pe={key:1,class:"space-y-2"},Je=["onDragstart","onDragover","onDrop"],He=["checked","onChange"],ie="sphinx-focus-tasks-encrypted",Ye=Z({__name:"TaskList",setup(y,{expose:f}){const{encrypt:c,decrypt:t}=Se(),{isUnlocked:o,hasSessionKey:i,getSessionKey:p}=xe(),l=x([]),d=x(""),m=x(null),q=x(null),D=x(!0);W(o,async e=>{e&&await G()},{immediate:!0});async function G(){if(!i()){D.value=!1;return}D.value=!0;try{const e=localStorage.getItem(ie);if(e){const a=p(),h=await t(e,a);l.value=JSON.parse(h),z()}}catch{l.value=[]}finally{D.value=!1}}async function $(){if(i())try{const e=p(),a=await c(JSON.stringify(l.value),e);localStorage.setItem(ie,a)}catch(e){console.error("Failed to save tasks:",e)}}W(l,()=>{Ie(()=>$())},{deep:!0});function j(){return`task-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function N(){return l.value.length===0?0:Math.max(...l.value.map(e=>e.order))+1}function L(){d.value.trim()&&(l.value.push({id:j(),text:d.value.trim(),completed:!1,order:N()}),d.value="",z())}function O(e){const a=l.value.findIndex(h=>h.id===e);a!==-1&&(l.value.splice(a,1),z())}function K(e){const a=l.value.find(h=>h.id===e);a&&(a.completed=!a.completed,z())}function z(){l.value.sort((e,a)=>e.completed!==a.completed?e.completed?1:-1:e.order-a.order)}function R(e,a){m.value=a,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",a))}function B(e,a){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move"),m.value!==a&&(q.value=a)}function V(){q.value=null}function A(e,a){if(e.preventDefault(),!m.value||m.value===a){m.value=null;return}const h=l.value.findIndex(_=>_.id===m.value),w=l.value.findIndex(_=>_.id===a);if(h!==-1&&w!==-1){const _=l.value[h],g=l.value[w];if(_&&g){const k=_.order,r=g.order;_.order=r,g.order=k,z()}}m.value=null,q.value=null}function M(){m.value=null,q.value=null}function s(e){e.key==="Enter"&&L()}return f({tasks:l}),(e,a)=>{const h=Ee,w=se,_=X;return u(),b("div",Ge,[v("div",je,[I(h,{modelValue:n(d),"onUpdate:modelValue":a[0]||(a[0]=g=>_e(d)?d.value=g:null),placeholder:"Add a new task...",class:"flex-1",onKeypress:s},null,8,["modelValue"]),I(w,{label:"Add",icon:"i-lucide-plus",disabled:!n(d).trim(),color:"primary",onClick:L},null,8,["disabled"])]),n(l).length===0?(u(),b("div",Ke,[...a[1]||(a[1]=[v("p",null,"No tasks yet. Add one above to get started!",-1)])])):(u(),b("div",Pe,[(u(!0),b(ke,null,Te(n(l),g=>(u(),b("div",{key:g.id,draggable:!0,class:S(["flex items-center gap-3 p-3 rounded-lg border border-border bg-default hover:bg-elevated transition-colors cursor-move",{"opacity-50":n(m)===g.id,"ring-2 ring-primary":n(q)===g.id&&n(m)!==g.id}]),onDragstart:k=>R(k,g.id),onDragover:k=>B(k,g.id),onDragleave:V,onDrop:k=>A(k,g.id),onDragend:M},[I(_,{name:"i-lucide-grip-vertical",class:"size-5 text-dimmed shrink-0"}),v("input",{type:"checkbox",checked:g.completed,class:"size-5 rounded border-border text-primary focus:ring-primary cursor-pointer",onChange:k=>K(g.id)},null,40,He),v("span",{class:S(["flex-1 text-default",{"line-through text-muted":g.completed}])},H(g.text),3),I(w,{icon:"i-lucide-trash-2",color:"error",variant:"ghost",size:"xs","aria-label":"Delete task",onClick:k=>O(g.id)},null,8,["onClick"])],42,Je))),128))]))])}}}),Qe=Object.assign(Ye,{__name:"TaskList"}),We={class:"container mx-auto px-4 py-6"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze={class:"text-lg font-semibold"},tt=Z({__name:"index",setup(y){const f=x(null),c=x(null),t=T(()=>{const i=f.value,p=c.value?.tasks||[];if(!i)return"Focus Timer";if(i.mode==="rest"&&(i.state==="running"||i.state==="paused"))return"Rest";if(i.mode==="focus"&&(i.state==="running"||i.state==="paused")){const l=p.find(d=>!d.completed);return l?l.text:"Focus Timer"}return"Focus Timer"}),o=T(()=>{const i=f.value;return i?i.state==="running"||i.state==="paused"?`${i.mode==="focus"?"FOCUS":"REST"} - ${i.formattedTime}`:i.mode==="focus"?"FOCUS":"REST":"Sphinx Focus"});return ze({title:o}),(i,p)=>{const l=Be,d=Ue,m=Qe;return u(),b("div",null,[v("div",We,[v("div",Xe,[I(d,null,{header:U(()=>[v("h3",Ze,H(n(t)),1)]),default:U(()=>[I(l,{ref_key:"focusTimerRef",ref:f},null,512)]),_:1}),I(d,null,{header:U(()=>[...p[0]||(p[0]=[v("h3",{class:"text-lg font-semibold"}," Task List ",-1)])]),default:U(()=>[I(m,{ref_key:"taskListRef",ref:c},null,512)]),_:1})])])])}}});export{tt as default};

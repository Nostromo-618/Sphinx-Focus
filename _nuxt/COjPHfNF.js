import{f as Z,r as x,g as de,h as se,i as Y,j as ne,k,l as ge,c as b,o as c,b as S,a as v,T as fe,w as O,m as C,n as s,t as Q,p as F,q as le,s as oe,v as re,x as W,y as T,z as M,P as ue,A as pe,B as me,C as ve,D as ye,E as he,F as ee,G as X,H as be,I as xe,J as _e,K as ke,L as Te,M as Se,N as Ie,u as ze}from"./vQoowmie.js";const te=globalThis.setInterval,we={class:"flex flex-col items-center justify-center p-6"},qe={key:0,class:"absolute top-2 left-2 right-2 p-3 rounded-lg bg-primary/10 border border-primary text-center text-sm font-medium text-primary animate-pulse"},Ce={class:"relative mb-6"},$e={class:"transform -rotate-90",width:"200",height:"200"},Re=["stroke-dasharray","stroke-dashoffset"],Ae={class:"absolute inset-0 flex flex-col items-center justify-center"},Fe={class:"text-4xl font-bold text-highlighted mb-1"},De={class:"text-sm text-muted"},Ne={class:"flex gap-2"},H=1500,ae=300,J="sphinx-focus-timer",Oe=Z({__name:"FocusTimer",setup(y,{expose:p}){const r=x("focus"),a=x("idle"),n=x(H),i=x(null),f=x(!1),o=de(),{isUnlocked:m}=se();function d(){const e={mode:r.value,state:a.value,timeRemaining:n.value,lastUpdateTimestamp:Date.now()};try{localStorage.setItem(J,JSON.stringify(e))}catch(t){console.error("Failed to save timer state:",t)}}function z(){try{const e=localStorage.getItem(J);if(!e)return;const t=JSON.parse(e);if(!t||typeof t.mode!="string"||typeof t.state!="string"||typeof t.timeRemaining!="number"||typeof t.lastUpdateTimestamp!="number"){localStorage.removeItem(J);return}if(r.value=t.mode,a.value=t.state,t.state==="running"){const l=Date.now(),q=Math.floor((l-t.lastUpdateTimestamp)/1e3),h=t.timeRemaining-q;if(h<=0){n.value=0,A();return}else n.value=h,a.value="running",i.value=te(()=>{n.value>0?(n.value--,d()):A()},1e3)}else n.value=t.timeRemaining}catch(e){console.error("Failed to load timer state:",e),localStorage.removeItem(J)}}Y([r,a],()=>{d()},{immediate:!1}),Y(m,(e,t)=>{t===!0&&!e&&(i.value&&(clearInterval(i.value),i.value=null),r.value="focus",a.value="idle",n.value=H,f.value=!1)}),ne(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),z()});function D(){try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),l=e.createGain();t.connect(l),l.connect(e.destination),t.frequency.value=800,t.type="sine",l.gain.setValueAtTime(.3,e.currentTime),l.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5)}catch{}}function E(e){if("Notification"in window&&Notification.permission==="granted"){const t=e==="focus"?"Focus session complete!":"Break is over!",l=e==="focus"?"Time for a break.":"Ready to focus again?";new Notification(t,{body:l,icon:"/favicon.ico"})}}function G(e){const t=e==="focus"?"Focus session complete!":"Break is over!",l=e==="focus"?"Great work! Time for a well-deserved break.":"Ready to focus again?";o.add({title:t,description:l,icon:e==="focus"?"i-lucide-coffee":"i-lucide-zap",color:e==="focus"?"success":"primary"})}const $=k(()=>r.value==="focus"?H:ae),j=k(()=>($.value-n.value)/$.value*100),R=k(()=>2*Math.PI*90),B=k(()=>R.value-j.value/100*R.value),U=k(()=>{const e=Math.floor(n.value/60),t=n.value%60;return`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`}),w=k(()=>r.value==="focus"?"Focus":"Rest");function V(){if(a.value==="running"){I();return}a.value="running",d(),i.value=te(()=>{n.value>0?(n.value--,d()):A()},1e3)}function I(){i.value&&(clearInterval(i.value),i.value=null),a.value="paused",d()}function L(){I(),a.value="idle",n.value=$.value,localStorage.removeItem(J)}function N(){I(),r.value==="focus"?(r.value="rest",n.value=ae):(r.value="focus",n.value=H),a.value="idle",d()}function A(){const e=r.value;D(),E(e),G(e),f.value=!0,setTimeout(()=>{f.value=!1},3e3),N()}function K(){N()}return ge(()=>{i.value&&clearInterval(i.value)}),p({mode:r,state:a,timeRemaining:n,formattedTime:U}),(e,t)=>{const l=le;return c(),b("div",we,[S(fe,{name:"fade"},{default:O(()=>[s(f)?(c(),b("div",qe," Session complete! ðŸŽ‰ ")):C("",!0)]),_:1}),v("div",Ce,[(c(),b("svg",$e,[t[0]||(t[0]=v("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"currentColor","stroke-width":"8",class:"text-border opacity-20"},null,-1)),v("circle",{cx:"100",cy:"100",r:"90",fill:"none",stroke:"currentColor","stroke-width":"8","stroke-dasharray":s(R),"stroke-dashoffset":s(B),class:"text-primary transition-all duration-1000 ease-linear","stroke-linecap":"round"},null,8,Re)])),v("div",Ae,[v("div",Fe,Q(s(U)),1),v("div",De,Q(s(w)),1)])]),v("div",Ne,[s(a)==="idle"?(c(),F(l,{key:0,label:"Start",icon:"i-lucide-play",color:"primary",onClick:V})):s(a)==="running"?(c(),F(l,{key:1,label:"Pause",icon:"i-lucide-pause",color:"warning",onClick:I})):s(a)==="paused"?(c(),F(l,{key:2,label:"Resume",icon:"i-lucide-play",color:"primary",onClick:V})):C("",!0),S(l,{label:"Skip",icon:"i-lucide-skip-forward",color:"neutral",variant:"outline",onClick:K}),S(l,{label:"Reset",icon:"i-lucide-rotate-ccw",color:"neutral",variant:"outline",disabled:s(a)==="idle"&&s(n)===s($),onClick:L},null,8,["disabled"])])])}}}),Be=Object.assign(Oe,{__name:"FocusTimer"}),Ue={slots:{root:"rounded-lg overflow-hidden",header:"p-4 sm:px-6",body:"p-4 sm:p-6",footer:"p-4 sm:px-6"},variants:{variant:{solid:{root:"bg-inverted text-inverted"},outline:{root:"bg-default ring ring-default divide-y divide-default"},soft:{root:"bg-elevated/50 divide-y divide-default"},subtle:{root:"bg-elevated/50 ring ring-default divide-y divide-default"}}},defaultVariants:{variant:"outline"}},Ve={__name:"UCard",props:{as:{type:null,required:!1},variant:{type:null,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(y){const p=y,r=oe(),a=re(),n=k(()=>W({extend:W(Ue),...a.ui?.card||{}})({variant:p.variant}));return(i,f)=>(c(),F(s(ue),{as:y.as,"data-slot":"root",class:T(n.value.root({class:[p.ui?.root,p.class]}))},{default:O(()=>[r.header?(c(),b("div",{key:0,"data-slot":"header",class:T(n.value.header({class:p.ui?.header}))},[M(i.$slots,"header")],2)):C("",!0),r.default?(c(),b("div",{key:1,"data-slot":"body",class:T(n.value.body({class:p.ui?.body}))},[M(i.$slots,"default")],2)):C("",!0),r.footer?(c(),b("div",{key:2,"data-slot":"footer",class:T(n.value.footer({class:p.ui?.footer}))},[M(i.$slots,"footer")],2)):C("",!0)]),_:3},8,["as","class"]))}},Le={slots:{root:"relative inline-flex items-center",base:["w-full rounded-md border-0 appearance-none placeholder:text-dimmed focus:outline-none disabled:cursor-not-allowed disabled:opacity-75","transition-colors"],leading:"absolute inset-y-0 start-0 flex items-center",leadingIcon:"shrink-0 text-dimmed",leadingAvatar:"shrink-0",leadingAvatarSize:"",trailing:"absolute inset-y-0 end-0 flex items-center",trailingIcon:"shrink-0 text-dimmed"},variants:{fieldGroup:{horizontal:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-e-none group-not-only:group-last:rounded-s-none group-not-last:group-not-first:rounded-none"},vertical:{root:"group has-focus-visible:z-[1]",base:"group-not-only:group-first:rounded-b-none group-not-only:group-last:rounded-t-none group-not-last:group-not-first:rounded-none"}},size:{xs:{base:"px-2 py-1 text-xs gap-1",leading:"ps-2",trailing:"pe-2",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},sm:{base:"px-2.5 py-1.5 text-xs gap-1.5",leading:"ps-2.5",trailing:"pe-2.5",leadingIcon:"size-4",leadingAvatarSize:"3xs",trailingIcon:"size-4"},md:{base:"px-2.5 py-1.5 text-sm gap-1.5",leading:"ps-2.5",trailing:"pe-2.5",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},lg:{base:"px-3 py-2 text-sm gap-2",leading:"ps-3",trailing:"pe-3",leadingIcon:"size-5",leadingAvatarSize:"2xs",trailingIcon:"size-5"},xl:{base:"px-3 py-2 text-base gap-2",leading:"ps-3",trailing:"pe-3",leadingIcon:"size-6",leadingAvatarSize:"xs",trailingIcon:"size-6"}},variant:{outline:"text-highlighted bg-default ring ring-inset ring-accented",soft:"text-highlighted bg-elevated/50 hover:bg-elevated focus:bg-elevated disabled:bg-elevated/50",subtle:"text-highlighted bg-elevated ring ring-inset ring-accented",ghost:"text-highlighted bg-transparent hover:bg-elevated focus:bg-elevated disabled:bg-transparent dark:disabled:bg-transparent",none:"text-highlighted bg-transparent"},color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},leading:{true:""},trailing:{true:""},loading:{true:""},highlight:{true:""},type:{file:"file:me-1.5 file:font-medium file:text-muted file:outline-none"}},compoundVariants:[{color:"primary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary"},{color:"secondary",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-secondary"},{color:"success",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-success"},{color:"info",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-info"},{color:"warning",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-warning"},{color:"error",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-error"},{color:"primary",highlight:!0,class:"ring ring-inset ring-primary"},{color:"secondary",highlight:!0,class:"ring ring-inset ring-secondary"},{color:"success",highlight:!0,class:"ring ring-inset ring-success"},{color:"info",highlight:!0,class:"ring ring-inset ring-info"},{color:"warning",highlight:!0,class:"ring ring-inset ring-warning"},{color:"error",highlight:!0,class:"ring ring-inset ring-error"},{color:"neutral",variant:["outline","subtle"],class:"focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-inverted"},{color:"neutral",highlight:!0,class:"ring ring-inset ring-inverted"},{leading:!0,size:"xs",class:"ps-7"},{leading:!0,size:"sm",class:"ps-8"},{leading:!0,size:"md",class:"ps-9"},{leading:!0,size:"lg",class:"ps-10"},{leading:!0,size:"xl",class:"ps-11"},{trailing:!0,size:"xs",class:"pe-7"},{trailing:!0,size:"sm",class:"pe-8"},{trailing:!0,size:"md",class:"pe-9"},{trailing:!0,size:"lg",class:"pe-10"},{trailing:!0,size:"xl",class:"pe-11"},{loading:!0,leading:!0,class:{leadingIcon:"animate-spin"}},{loading:!0,leading:!1,trailing:!0,class:{trailingIcon:"animate-spin"}}],defaultVariants:{size:"md",color:"primary",variant:"outline"}},Me=["id","type","value","name","placeholder","disabled","required","autocomplete"],Ee=Object.assign({inheritAttrs:!1},{__name:"UInput",props:{as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},type:{type:null,required:!1,default:"text"},placeholder:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},required:{type:Boolean,required:!1},autocomplete:{type:null,required:!1,default:"off"},autofocus:{type:Boolean,required:!1},autofocusDelay:{type:Number,required:!1,default:0},disabled:{type:Boolean,required:!1},highlight:{type:Boolean,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},modelModifiers:{type:Object,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},icon:{type:null,required:!1},avatar:{type:Object,required:!1},leading:{type:Boolean,required:!1},leadingIcon:{type:null,required:!1},trailing:{type:Boolean,required:!1},trailingIcon:{type:null,required:!1},loading:{type:Boolean,required:!1},loadingIcon:{type:null,required:!1}},emits:["update:modelValue","blur","change"],setup(y,{expose:p,emit:r}){const a=y,n=r,i=oe(),f=pe(a,"modelValue",n,{defaultValue:a.defaultValue}),o=re(),{emitFormBlur:m,emitFormInput:d,emitFormChange:z,size:D,color:E,id:G,name:$,highlight:j,disabled:R,emitFormFocus:B,ariaAttrs:U}=me(a,{}),{orientation:w,size:V}=ve(a),{isLeading:I,isTrailing:L,leadingIconName:N,trailingIconName:A}=ye(a),K=k(()=>V.value||D.value),e=k(()=>W({extend:W(Le),...o.ui?.input||{}})({type:a.type,color:E.value,variant:a.variant,size:K?.value,loading:a.loading,highlight:j.value,leading:I.value||!!a.avatar||!!i.leading,trailing:L.value||!!i.trailing,fieldGroup:w.value})),t=he("inputRef");function l(u){a.modelModifiers?.trim&&(u=u?.trim()??null),(a.modelModifiers?.number||a.type==="number")&&(u=xe(u)),a.modelModifiers?.nullable&&(u||=null),a.modelModifiers?.optional&&(u||=void 0),f.value=u,d()}function q(u){a.modelModifiers?.lazy||l(u.target.value)}function h(u){const P=u.target.value;a.modelModifiers?.lazy&&l(P),a.modelModifiers?.trim&&(u.target.value=P.trim()),z(),n("change",u)}function g(u){m(),n("blur",u)}function _(){a.autofocus&&t.value?.focus()}return ne(()=>{setTimeout(()=>{_()},a.autofocusDelay)}),p({inputRef:t}),(u,P)=>(c(),F(s(ue),{as:y.as,"data-slot":"root",class:T(e.value.root({class:[a.ui?.root,a.class]}))},{default:O(()=>[v("input",ee({id:s(G),ref_key:"inputRef",ref:t,type:y.type,value:s(f),name:s($),placeholder:y.placeholder,"data-slot":"base",class:e.value.base({class:a.ui?.base}),disabled:s(R),required:y.required,autocomplete:y.autocomplete},{...u.$attrs,...s(U)},{onInput:q,onBlur:g,onChange:h,onFocus:P[0]||(P[0]=(...ce)=>s(B)&&s(B)(...ce))}),null,16,Me),M(u.$slots,"default",{ui:e.value}),s(I)||y.avatar||i.leading?(c(),b("span",{key:0,"data-slot":"leading",class:T(e.value.leading({class:a.ui?.leading}))},[M(u.$slots,"leading",{ui:e.value},()=>[s(I)&&s(N)?(c(),F(X,{key:0,name:s(N),"data-slot":"leadingIcon",class:T(e.value.leadingIcon({class:a.ui?.leadingIcon}))},null,8,["name","class"])):y.avatar?(c(),F(be,ee({key:1,size:a.ui?.leadingAvatarSize||e.value.leadingAvatarSize()},y.avatar,{"data-slot":"leadingAvatar",class:e.value.leadingAvatar({class:a.ui?.leadingAvatar})}),null,16,["size","class"])):C("",!0)])],2)):C("",!0),s(L)||i.trailing?(c(),b("span",{key:1,"data-slot":"trailing",class:T(e.value.trailing({class:a.ui?.trailing}))},[M(u.$slots,"trailing",{ui:e.value},()=>[s(A)?(c(),F(X,{key:0,name:s(A),"data-slot":"trailingIcon",class:T(e.value.trailingIcon({class:a.ui?.trailingIcon}))},null,8,["name","class"])):C("",!0)])],2)):C("",!0)]),_:3},8,["as","class"]))}}),Ge={class:"space-y-4"},je={class:"flex gap-2"},Ke={key:0,class:"text-center py-8 text-muted"},Pe={key:1,class:"space-y-2"},Je=["onDragstart","onDragover","onDrop"],He=["checked","onChange"],ie="sphinx-focus-tasks-encrypted",Ye=Z({__name:"TaskList",setup(y,{expose:p}){const{encrypt:r,decrypt:a}=Se(),{isUnlocked:n,hasSessionKey:i,getSessionKey:f}=se(),o=x([]),m=x(""),d=x(null),z=x(null),D=x(!0);Y(n,async e=>{e?await E():o.value=[]},{immediate:!0});async function E(){if(!i()){D.value=!1;return}D.value=!0;try{const e=localStorage.getItem(ie);if(e){const t=f(),l=await a(e,t);o.value=JSON.parse(l),w()}}catch{o.value=[]}finally{D.value=!1}}async function G(){if(i())try{const e=f(),t=await r(JSON.stringify(o.value),e);localStorage.setItem(ie,t)}catch(e){console.error("Failed to save tasks:",e)}}Y(o,()=>{Ie(()=>G())},{deep:!0});function $(){return`task-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function j(){return o.value.length===0?0:Math.max(...o.value.map(e=>e.order))+1}function R(){m.value.trim()&&(o.value.push({id:$(),text:m.value.trim(),completed:!1,order:j()}),m.value="",w())}function B(e){const t=o.value.findIndex(l=>l.id===e);t!==-1&&(o.value.splice(t,1),w())}function U(e){const t=o.value.find(l=>l.id===e);t&&(t.completed=!t.completed,w())}function w(){o.value.sort((e,t)=>e.completed!==t.completed?e.completed?1:-1:e.order-t.order)}function V(e,t){d.value=t,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t))}function I(e,t){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move"),d.value!==t&&(z.value=t)}function L(){z.value=null}function N(e,t){if(e.preventDefault(),!d.value||d.value===t){d.value=null;return}const l=o.value.findIndex(h=>h.id===d.value),q=o.value.findIndex(h=>h.id===t);if(l!==-1&&q!==-1){const h=o.value[l],g=o.value[q];if(h&&g){const _=h.order,u=g.order;h.order=u,g.order=_,w()}}d.value=null,z.value=null}function A(){d.value=null,z.value=null}function K(e){e.key==="Enter"&&R()}return p({tasks:o}),(e,t)=>{const l=Ee,q=le,h=X;return c(),b("div",Ge,[v("div",je,[S(l,{modelValue:s(m),"onUpdate:modelValue":t[0]||(t[0]=g=>_e(m)?m.value=g:null),placeholder:"Add a new task...",class:"flex-1",onKeypress:K},null,8,["modelValue"]),S(q,{label:"Add",icon:"i-lucide-plus",disabled:!s(m).trim(),color:"primary",onClick:R},null,8,["disabled"])]),s(o).length===0?(c(),b("div",Ke,[...t[1]||(t[1]=[v("p",null,"No tasks yet. Add one above to get started!",-1)])])):(c(),b("div",Pe,[(c(!0),b(ke,null,Te(s(o),g=>(c(),b("div",{key:g.id,draggable:!0,class:T(["flex items-center gap-3 p-3 rounded-lg border border-border bg-default hover:bg-elevated transition-colors cursor-move",{"opacity-50":s(d)===g.id,"ring-2 ring-primary":s(z)===g.id&&s(d)!==g.id}]),onDragstart:_=>V(_,g.id),onDragover:_=>I(_,g.id),onDragleave:L,onDrop:_=>N(_,g.id),onDragend:A},[S(h,{name:"i-lucide-grip-vertical",class:"size-5 text-dimmed shrink-0"}),v("input",{type:"checkbox",checked:g.completed,class:"size-5 rounded border-border text-primary focus:ring-primary cursor-pointer",onChange:_=>U(g.id)},null,40,He),v("span",{class:T(["flex-1 text-default",{"line-through text-muted":g.completed}])},Q(g.text),3),S(q,{icon:"i-lucide-trash-2",color:"error",variant:"ghost",size:"xs","aria-label":"Delete task",onClick:_=>B(g.id)},null,8,["onClick"])],42,Je))),128))]))])}}}),Qe=Object.assign(Ye,{__name:"TaskList"}),We={class:"container mx-auto px-4 py-6"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze={class:"text-lg font-semibold"},tt=Z({__name:"index",setup(y){const p=x(null),r=x(null),a=k(()=>{const i=p.value,f=r.value?.tasks||[];if(!i)return"Focus Timer";if(i.mode==="rest"&&(i.state==="running"||i.state==="paused"))return"Rest";if(i.mode==="focus"&&(i.state==="running"||i.state==="paused")){const o=f.find(m=>!m.completed);return o?o.text:"Focus Timer"}return"Focus Timer"}),n=k(()=>{const i=p.value;return i?i.state==="running"||i.state==="paused"?`${i.mode==="focus"?"FOCUS":"REST"} - ${i.formattedTime}`:i.mode==="focus"?"FOCUS":"REST":"Sphinx Focus"});return ze({title:n}),(i,f)=>{const o=Be,m=Ve,d=Qe;return c(),b("div",null,[v("div",We,[v("div",Xe,[S(m,null,{header:O(()=>[v("h3",Ze,Q(s(a)),1)]),default:O(()=>[S(o,{ref_key:"focusTimerRef",ref:p},null,512)]),_:1}),S(m,null,{header:O(()=>[...f[0]||(f[0]=[v("h3",{class:"text-lg font-semibold"}," Task List ",-1)])]),default:O(()=>[S(d,{ref_key:"taskListRef",ref:r},null,512)]),_:1})])])])}}});export{tt as default};
